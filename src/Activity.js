import React, { useEffect, useState } from "react";
import { createStyles, makeStyles } from "@material-ui/core/styles";
import "date-fns";
import DateFnsUtils from "@date-io/date-fns";
import {
  MuiPickersUtilsProvider,
  KeyboardDatePicker,
} from "@material-ui/pickers";
import AppBar from "@material-ui/core/AppBar";
import Toolbar from "@material-ui/core/Toolbar";
import Grid from "@material-ui/core/Grid";
import Activitycards from "./Activitycards.js";
import Button from "@material-ui/core/Button";
import FilterListIcon from "@material-ui/icons/FilterList";
import { Menu, MenuItem } from "@material-ui/core";
import { db } from "./firebase.js";

const useStyles = makeStyles((theme) =>
  createStyles({
    root: {
      flexGrow: 1,
    },
    menuButton: {
      marginRight: theme.spacing(1),
    },
    title: {
      flexGrow: 1,
    },
    customizeToolbar: {
      minHeight: 36,
      backgroundColor: "white",
    },
    Grid: {
      padding: 40,
      justifyContent: "center",
      alignItems: "center",
    },
    Typography: {
      color: "black",
    },
    card: {
      width: "60vw",
    },
  })
);

export default function Activity() {
  const classes = useStyles();

  const [anchorEl, setAnchorEl] = useState(null);
  const handleOpenMenu = (e) => {
    setAnchorEl(e.currentTarget);
  };
  const handleMenuClose = () => {
    setAnchorEl(null);
  };

  const [selectedDate, setSelectedDate] = React.useState(new Date());
  const handleDateChange = (date) => {
    setSelectedDate(date);
  };
  const [activities, setActivities] = useState([]);
  useEffect(() => {
    db.collection("visitation_log")
      .get()
      .then((querySnapshot) => {
        let docs = [];
        querySnapshot.forEach(function (doc) {
          docs.push(doc.data());
        });
        setActivities(docs);
        //console.log(docs)
      })
      .catch((err) => console.log(err));
  }, []);
  return (
    <>
      <div className={classes.root}>
        <AppBar position="static">
          <Toolbar className={classes.customizeToolbar}>
            <Button
              aria-controls="menu"
              onClick={handleOpenMenu}
              style={{ marginLeft: 20, marginRight: 20 }}
            >
              <FilterListIcon fontSize="medium" /> Filter
            </Button>

            <Menu
              style={{ marginTop: "35px" }}
              id="menu"
              onClose={handleMenuClose}
              anchorEl={anchorEl}
              open={Boolean(anchorEl)}
            >
              <MenuItem>Filter By Name</MenuItem>
              <MenuItem>Filter By Date</MenuItem>
            </Menu>

            <MuiPickersUtilsProvider
              utils={DateFnsUtils}
              className={classes.Date}
            >
              <KeyboardDatePicker
                disableToolbar
                variant="inline"
                format="dd/MM/yyyy"
                margin="normal"
                id="date-picker"
                value={selectedDate}
                onChange={handleDateChange}
                KeyboardButtonProps={{
                  "aria-lbel": "change date",
                }}
              />
            </MuiPickersUtilsProvider>
          </Toolbar>
        </AppBar>
      </div>

      <Grid container className={classes.Grid}>
        {activities.map(
          ({ purpose, is_wearing_mask, temperature, user_id }, key) => {
            //console.log(temperature);
            return (
              <Activitycards
                purpose={purpose}
                key={key}
                is_wearing_mask={is_wearing_mask}
                temperature={temperature}
                user_id={user_id}
                subheader="09:45 AM | Others"
                typography3="Allowed by you"
                myButton1="<CallIcon/>"
                myButton2="Wrong Entry"
                myButton3="Gate Pass"
              />
            );
          }
        )}
        {/* <Activitycards
          purpose={}
          title="Visiting Help"
          subheader="09:45 AM | Others"
          typography1="Dilshad"
          typography2="Temp- 97.1 Deg | Mask-on"
          typography3="Allowed by you"
          myButton1="<CallIcon/>"
          myButton2="Wrong Entry"
          myButton3="Gate Pass"
        />
        <Activitycards
          title="Visiting Help"
          subheader="09:39 AM | Others"
          typography1="Ganesh"
          typography2="Temp- 97.1 Deg | Mask-on"
          typography3="Allowed by you"
          myButton1="<CallIcon/>"
          myButton2="Wrong Entry"
          myButton3="Gate Pass"
        />
        <Activitycards
          title="Visiting Help"
          subheader="09:45 AM | Others"
          typography1="Suresh"
          typography2="Temp- 97.1 Deg | Mask-on"
          typography3="Allowed by guard RAVINDRA PRASAD SINGH"
          myButton1="<CallIcon/>"
          myButton2="Wrong Entry"
          myButton3="Gate Pass"
        /> */}
      </Grid>
    </>
  );
}
